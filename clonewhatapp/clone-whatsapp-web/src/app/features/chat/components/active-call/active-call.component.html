<div class="active-call-overlay" [class.video-call]="isVideo">
  @if (isVideo) {
    <!-- Video call layout -->
    <video #remoteVideo class="remote-video" autoplay playsinline></video>
    <video #localVideo class="local-video" autoplay playsinline muted></video>
  } @else {
    <!-- Voice call layout -->
    <div class="voice-call-ui">
      <div class="caller-avatar">
        {{ otherUserName.charAt(0) }}
      </div>
      <h2 class="caller-name">{{ otherUserName }}</h2>
      <p class="call-duration">{{ duration }}</p>
    </div>
  }

  <!-- Call controls -->
  <div class="call-controls">
    <button
      class="control-btn"
      [class.off]="!isAudioEnabled"
      (click)="toggleMute()"
      title="Silenciar"
    >
      @if (isAudioEnabled) {
        <svg viewBox="0 0 24 24" width="24" height="24">
          <path fill="currentColor" d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.91-3c-.49 0-.9.36-.98.85C16.52 14.2 14.47 16 12 16s-4.52-1.8-4.93-4.15c-.08-.49-.49-.85-.98-.85-.61 0-1.09.54-1 1.14.49 3 2.89 5.35 5.91 5.78V20c0 .55.45 1 1 1s1-.45 1-1v-2.08c3.02-.43 5.42-2.78 5.91-5.78.1-.6-.39-1.14-1-1.14z"/>
        </svg>
      } @else {
        <svg viewBox="0 0 24 24" width="24" height="24">
          <path fill="currentColor" d="M19 11h-1.7c0 .74-.16 1.43-.43 2.05l1.23 1.23c.56-.98.9-2.09.9-3.28zm-4.02.17c0-.06.02-.11.02-.17V5c0-1.66-1.34-3-3-3S9 3.34 9 5v.18l5.98 5.99zM4.27 3L3 4.27l6.01 6.01V11c0 1.66 1.33 3 2.99 3 .22 0 .44-.03.65-.08l1.66 1.66c-.71.33-1.5.52-2.31.52-2.76 0-5.3-2.1-5.3-5.1H5c0 3.41 2.72 6.23 6 6.72V20c0 .55.45 1 1 1s1-.45 1-1v-2.28c.91-.13 1.77-.45 2.54-.9L19.73 21 21 19.73 4.27 3z"/>
        </svg>
      }
    </button>

    @if (isVideo) {
      <button
        class="control-btn"
        [class.off]="!isVideoEnabled"
        (click)="toggleVideo()"
        title="CÃ¡mara"
      >
        @if (isVideoEnabled) {
          <svg viewBox="0 0 24 24" width="24" height="24">
            <path fill="currentColor" d="M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z"/>
          </svg>
        } @else {
          <svg viewBox="0 0 24 24" width="24" height="24">
            <path fill="currentColor" d="M21 6.5l-4 4V7c0-.55-.45-1-1-1H9.82L21 17.18V6.5zM3.27 2L2 3.27 4.73 6H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.21 0 .39-.08.54-.18L19.73 21 21 19.73 3.27 2z"/>
          </svg>
        }
      </button>
    }

    <button class="control-btn end-call" (click)="endCall()" title="Colgar">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <path fill="currentColor" d="M12 9c-1.6 0-3.15.25-4.6.72v3.1c0 .39-.23.74-.56.9-.98.49-1.87 1.12-2.66 1.85-.18.18-.43.28-.7.28-.28 0-.53-.11-.71-.29L.29 13.08c-.18-.17-.29-.42-.29-.7 0-.28.11-.53.29-.71C3.34 8.78 7.46 7 12 7s8.66 1.78 11.71 4.67c.18.18.29.43.29.71 0 .28-.11.53-.29.71l-2.48 2.48c-.18.18-.43.29-.71.29-.27 0-.52-.1-.7-.28-.79-.73-1.68-1.36-2.66-1.85-.33-.16-.56-.5-.56-.9v-3.1C15.15 9.25 13.6 9 12 9z"/>
      </svg>
    </button>
  </div>

  <!-- Duration for video calls -->
  @if (isVideo) {
    <div class="video-call-info">
      <span class="duration">{{ duration }}</span>
    </div>
  }
</div>
